%%%
%%% calcAlphaBeta
%%%
%%% Approximates the Boussinesq thermal expansion and haline contractions 
%%% coefficients, and their derivatives with respect to temperature, 
%%% salinity and depth.
%%%
function [alpha,beta,dalpha_dT,dalpha_dS,dalpha_dz, ...
                  dbeta_dT,dbeta_dS,dbeta_dz] = calcAlphaBeta(SP,PT,PP)

  dPT = 1e-3;
  dSP = 1e-3;
  dPP = 1;  
  alpha = - (densmdjwf(SP,PT+0.5*dPT,PP) ...
                - densmdjwf(SP,PT-0.5*dPT,PP) ) ...
                ./ densmdjwf(SP,PT,PP) / dPT;
  beta = (densmdjwf(SP+0.5*dSP,PT,PP) ...
                - densmdjwf(SP-0.5*dSP,PT,PP) ) ...
                ./ densmdjwf(SP,PT,PP) / dSP;
  dalpha_dT = - ( (densmdjwf(SP,PT+dPT,PP) ...
                  - densmdjwf(SP,PT,PP) ) ...
                    ./ densmdjwf(SP,PT+0.5*dPT,PP) ...
              - (densmdjwf(SP,PT,PP) ...
                  - densmdjwf(SP,PT-dPT,PP) ) ...
                    ./ densmdjwf(SP,PT-0.5*dPT,PP) ) ...
              / dPT^2;
  dalpha_dS = - ( (densmdjwf(SP+0.5*dSP,PT+0.5*dPT,PP) ...
                  - densmdjwf(SP+0.5*dSP,PT-0.5*dPT,PP) ) ...
                    ./ densmdjwf(SP+0.5*dSP,PT,PP) ...
              - (densmdjwf(SP-0.5*dSP,PT+0.5*dPT,PP) ...
                  - densmdjwf(SP-0.5*dSP,PT-0.5*dPT,PP) ) ...
                    ./ densmdjwf(SP-0.5*dSP,PT,PP) ) ...
              / dPT / dSP;
  dalpha_dz = - ( (densmdjwf(SP,PT+0.5*dPT,PP-0.5*dPP) ...
                  - densmdjwf(SP,PT-0.5*dPT,PP-0.5*dPP) ) ...
                    ./ densmdjwf(SP,PT,PP-0.5*dPP) ...
              - (densmdjwf(SP,PT+0.5*dPT,PP+0.5*dPP) ...
                  - densmdjwf(SP,PT-0.5*dPT,PP+0.5*dPP) ) ...
                    ./ densmdjwf(SP,PT,PP+0.5*dPP) ) ...
              / dPT / dPP;
  dbeta_dT = ( (densmdjwf(SP+0.5*dSP,PT+0.5*dPT,PP) ...
                  - densmdjwf(SP-0.5*dSP,PT+0.5*dPT,PP) ) ...
                    ./ densmdjwf(SP,PT+0.5*dPT,PP) ...
              - (densmdjwf(SP+0.5*dSP,PT-0.5*dPT,PP) ...
                  - densmdjwf(SP-0.5*dSP,PT-0.5*dPT,PP) ) ...
                    ./ densmdjwf(SP,PT-0.5*dPT,PP) ) ...
              / dPT / dSP;
  dbeta_dS = ( (densmdjwf(SP+dSP,PT,PP) ...
                  - densmdjwf(SP,PT,PP) ) ...
                    ./ densmdjwf(SP+0.5*dSP,PT,PP) ...
              - (densmdjwf(SP,PT,PP) ...
                  - densmdjwf(SP-dSP,PT,PP) ) ...
                    ./ densmdjwf(SP-0.5*dSP,PT,PP) ) ...
              / dSP^2;
  dbeta_dz = ( (densmdjwf(SP+0.5*dSP,PT,PP-0.5*dPP) ...
                  - densmdjwf(SP-0.5*dSP,PT,PP-0.5*dPP) ) ...
                    ./ densmdjwf(SP,PT,PP-0.5*dPP) ...
              - (densmdjwf(SP+0.5*dSP,PT,PP+0.5*dPP) ...
                  - densmdjwf(SP-0.5*dSP,PT,PP+0.5*dPP) ) ...
                    ./ densmdjwf(SP,PT,PP+0.5*dPP) ) ...
              / dPP / dSP;
          
end

